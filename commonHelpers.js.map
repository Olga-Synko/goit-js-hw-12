{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\naxios.defaults.baseURL = 'https://pixabay.com';\n\n\n\nexport async function getImages(value, page) {\n    const res = await axios.get('/api/', {\n        params: {\n            key: \"44767579-3ee2796193c18f7fdbcfe2f8d\",\n            q: value,\n            image_type: \"photo\",\n            orientation: \"horizontal\",\n            safesearch: true,\n            per_page: 15,\n            page: page\n        }\n    });\n\n    return res.data;\n}","// export function createMarkup(arr) {\n//     return arr\n//         .map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => `\n//     <li class=\"gallery-item\">\n//       <div class=\"gallery\">\n//        <a class=\"gallery-link\" href=\"${largeImageURL}\">\n//        <img class=\"gallery-image\"\n//          src=\"${webformatURL}\"\n//          alt=\"${tags}\"\n//         />\n//        </a>\n       \n//       <ul class=\"card-description\">\n//         <li class=\"description\">Likes <span class=\"accent\">${likes} </span></li>\n//         <li class=\"description\">Views <span class=\"accent\">${views} </span></li>\n//         <li class=\"description\">Comments <span class=\"accent\">${comments} </span></li>\n//         <li class=\"description\">Downloads <span class=\"accent\">${downloads} </span></li>\n//       </ul>\n//       </div>\n//     </li>\n//     `).join(\"\");\n// }\n\nexport function renderImage(data) {\n  return data.map(image => `<li class=\"gallery-item\">\n      <div class=\"image-cont\">\n        <a class=\"gallery-link\" href=\"${image.largeImageURL}\">\n          <img class=\"gallery-image\" src=\"${image.webformatURL}\" alt=\"${image.tags}\" />\n        </a>\n        <div class=\"image-descr\">\n          <div class=\"descr-box\">\n            <p class=\"image-feature\">Likes</p>\n            <p class=\"image-data\">${image.likes}</p>\n          </div>\n          <div class=\"descr-box\">\n            <p class=\"image-feature\">Views</p>\n            <p class=\"image-data\">${image.views}</p>\n          </div>\n          <div class=\"descr-box\">\n            <p class=\"image-feature\">Comments</p>\n            <p class=\"image-data\">${image.comments}</p>\n          </div>\n          <div class=\"descr-box\">\n            <p class=\"image-feature\">Downloads</p>\n              <p class=\"image-data\">${image.downloads}</p>\n          </div>\n        </div>\n      </div>\n    </li>\n  `).join('');\n}","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport { getImages } from \"./js/pixabay-api\";\nimport { renderImage } from \"./js/render-functions\";\n\n\nconst loadMoreBtn = document.querySelector('.load-more-btn');\nconst form = document.querySelector('.search-form');\nconst input = document.querySelector('.search-input');\nconst list = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader')\n\nlet currentPage;\nlet currentQuery = '';\nlet maxPage;\nconst perPage = 15;\n\nlet lightbox = new SimpleLightbox('.gallery a', {\n    captions: true,\n    captionDelay: 250,\n    captionPosition: 'bottom',\n    captionsData: 'alt',\n});\n\n\n\nform.addEventListener('submit', async (event) => {\n    event.preventDefault();\n    currentQuery = event.target.elements.query.value.trim();\n    currentPage = 1;\n\n    showLoader();\n    hideLoadBtn();\n    list.innerHTML = '';\n\n    if (currentQuery === '') {\n        iziToast.error({\n            position: \"topRight\",\n            message: 'Please enter some text',\n        });\n        hideLoader();\n        return;\n    }\n\n    try {\n        const data = await getImages(currentQuery, currentPage);\n        maxPage = Math.ceil(data.totalHits / perPage);\n\n        if (data.hits && data.hits.length > 0) {\n            const markup = renderImage(data.hits);\n            list.insertAdjacentHTML(\"beforeend\", markup);\n\n            hideLoader();\n            hideLoadBtn();\n\n            lightbox.refresh();\n        } else {\n            iziToast.error({\n                position: \"topRight\",\n                message: 'Sorry, there are no images matching your search query. Please try again!',\n            })\n            hideLoader();\n            hideLoadBtn();\n        }\n    } catch (err) {\n        console.log(err);\n        hideLoadBtn();\n        hideLoader();\n        iziToast.error({\n            position: \"topRight\",\n            message: 'Sorry, the request can\\'t be completed at this time. Please try again',\n        })\n    }\n\n    input.value = '';\n    updateBtnStatus();\n});\n\n\nloadMoreBtn.addEventListener('click', async () => {\n    currentPage++;\n    showLoader();\n    hideLoadBtn();\n\n    try {\n        const data = await getImages(currentQuery, currentPage);\n        const markup = renderImage(data.hits);\n        list.insertAdjacentHTML(\"beforeend\", markup);\n        lightbox.refresh();\n        scrollPage();\n    } catch (err) {\n        console.log(err);\n        iziToast.error({\n            position: \"bottomRight\",\n            message: 'Sorry, the request can\\'t be completed at this time. Please try again',\n        })\n    }\n\n    hideLoader();\n    updateBtnStatus();\n});\n\n\nfunction showLoadBtn() {\n    loadMoreBtn.classList.remove('visually-hidden');\n}\n\nfunction hideLoadBtn() {\n    loadMoreBtn.classList.add('visually-hidden');\n}\n\nfunction showLoader() {\n    loader.classList.remove('visually-hidden');\n}\n\nfunction hideLoader() {\n    loader.classList.add('visually-hidden');\n}\n\nfunction updateBtnStatus() {\n    if (currentPage >= maxPage) {\n        hideLoadBtn();\n\n        if (maxPage) {\n            iziToast.info({\n                position: \"bottomRight\",\n                message: 'We\\'re sorry, but you\\'ve reached the end of search results',\n            })\n            hideLoadBtn();\n        }\n    } else {\n        showLoadBtn();\n    }\n}\n\nfunction scrollPage() {\n    const liElem = list.children[0];\n    const height = liElem.getBoundingClientRect().height;\n\n    scrollBy({\n        top: height * 2,\n        behavior: \"smooth\",\n    });\n}"],"names":["axios","getImages","value","page","renderImage","data","image","loadMoreBtn","form","input","list","loader","currentPage","currentQuery","maxPage","perPage","lightbox","SimpleLightbox","event","showLoader","hideLoadBtn","iziToast","hideLoader","markup","err","updateBtnStatus","scrollPage","showLoadBtn","height"],"mappings":"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"}